name: Ping Supabase to Prevent Pausing

on:
  schedule:
    - cron: '0 9 * * 1,4' # 9 AM UTC Mon & Thu
  workflow_dispatch: # Manual trigger

jobs:
  ping:
    runs-on: ubuntu-latest
    steps:
      - name: Run Node script to ping Supabase
        env:
          SUPABASE_URL: ${{ secrets.SUPABASE_URL }}
          SUPABASE_KEY: ${{ secrets.SUPABASE_KEY }}
        run: |
          sudo apt-get install -y nodejs npm # Chatgpt: Installs Node.js if not preinstalled
          npm install @supabase/supabase-js --force # Chatgpt: Installs Supabase client
          node -e "
          (async () => {
            const { createClient } = require('@supabase/supabase-js');
            const supabase = createClient(process.env.SUPABASE_URL, process.env.SUPABASE_KEY);
            const { data, error } = await supabase.from('your_table').select('*').limit(1);
            if (error) throw error;
            console.log('Ping successful:', data);
          })();
          "
